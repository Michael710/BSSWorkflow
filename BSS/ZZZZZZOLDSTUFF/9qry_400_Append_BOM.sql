spool qry_400.LSTset echo ontruncate table source_bom;--select * from source_bom;-- Move data from TGT_BOM into SOURCE_BOM-- INSERT INTO SOURCE_BOM (QUANTITY, TEXT01, TEXT02, TEXT03, TEXT04)--                 SELECT QUANTITY, PARENT_TOY_NUMBER, PARENT_PART_NUMBER, COMPONENT_TOY_NUMBER, COMPONENT_PART_NUMBER--                   FROM TGT_BOM;-- commit;-- TGT_REL_ASSM_MC_TO_PRODUCT-- TGT_REL_ASSM_RC_TO_PRODUCT-- TGT_REL_GRS_TO_GRS-- TGT_REL_PRODUCT_TO_PRODUCT-- TGT_REL_ASST_MODELSELECT COUNT(*) FROM TGT_REL_ASSM_MC_TO_PRODUCT;--SELECT * FROM TGT_REL_ASSM_MC_TO_PRODUCT;INSERT INTO SOURCE_BOM(PARENT_NUMBER,ITEM_NUMBER,QUANTITY,TEXT01,TEXT02,TEXT03,TEXT04,TEXT05)SELECT PAR1.ITEM_NUMBER AS PARENT, CHLD1.ITEM_NUMBER AS CHILD,  M_QUANTITY,'TGT_REL_ASSM_MC_TO_PRODUCT', M_PROD_MATTEL_PRODUCT_NUMBER, M_PROD_MATTEL_DASH_CODE,M_ASSM_MATTEL_PRODUCT_NUMBER,M_ASSM_MATTEL_DASH_CODE  -- LOAD_DTFROM TGT_REL_ASSM_MC_TO_PRODUCTLEFT OUTER JOIN SOURCE_ITEM PAR1 ON RPAD(PAR1.P2_TEXT14,5) = RPAD(M_PROD_MATTEL_PRODUCT_NUMBER,5)                      AND RPAD(PAR1.P2_TEXT15,5) = RPAD(M_PROD_MATTEL_DASH_CODE,5)                      AND PAR1.SUBCLASS LIKE 'Assembly - Carton%'                      AND PAR1.subclass <> 'Electronics Specification Document'LEFT OUTER JOIN SOURCE_ITEM CHLD1 ON RPAD(CHLD1.P2_TEXT14,5) = RPAD(M_ASSM_MATTEL_PRODUCT_NUMBER,5)                                 AND RPAD(CHLD1.P2_TEXT15,5) =  RPAD(M_ASSM_MATTEL_DASH_CODE,5)                                 AND CHLD1.SUBCLASS NOT LIKE 'Asse%'                                 AND CHLD1.subclass <> 'Electronics Specification Document'order by parent; COMMIT;SELECT COUNT(*) FROM TGT_REL_ASSM_RC_TO_PRODUCT;INSERT INTO SOURCE_BOM(PARENT_NUMBER,ITEM_NUMBER,QUANTITY,TEXT01,TEXT02,TEXT03,TEXT04,TEXT05)SELECT   PAR1.ITEM_NUMBER AS PARENT,   CHLD1.ITEM_NUMBER AS CHILD,    M_QUANTITY,  'TGT_REL_ASSM_RC_TO_PRODUCT'   , M_PROD_MATTEL_PRODUCT_NUMBER, M_PROD_MATTEL_DASH_CODE,M_ASSM_MATTEL_PRODUCT_NUMBER,M_ASSM_MATTEL_DASH_CODE  -- LOAD_DTFROM TGT_REL_ASSM_RC_TO_PRODUCTLEFT OUTER JOIN SOURCE_ITEM PAR1 ON RPAD(PAR1.P2_TEXT14,5) = RPAD(M_PROD_MATTEL_PRODUCT_NUMBER,5)                      AND RPAD(PAR1.P2_TEXT15,5) = RPAD(M_PROD_MATTEL_DASH_CODE,5)                      AND PAR1.SUBCLASS LIKE 'Assembly - Retail Packaging%'                      AND PAR1.subclass <> 'Electronics Specification Document'LEFT OUTER JOIN SOURCE_ITEM CHLD1 ON RPAD(CHLD1.P2_TEXT14,5) = RPAD(M_ASSM_MATTEL_PRODUCT_NUMBER,5)                                 AND RPAD(CHLD1.P2_TEXT15,5) = RPAD(M_ASSM_MATTEL_DASH_CODE,5)                                 AND CHLD1.SUBCLASS NOT LIKE 'Asse%'                                 AND CHLD1.subclass <> 'Electronics Specification Document' order by parent;                                  COMMIT;SELECT COUNT (*) FROM TGT_REL_PRODUCT_TO_PRODUCT;INSERT INTO SOURCE_BOM(PARENT_NUMBER,ITEM_NUMBER,QUANTITY,TEXT01,TEXT02,TEXT03,TEXT04,TEXT05)SELECT   PAR1.ITEM_NUMBER AS PARENT,   CHLD1.ITEM_NUMBER AS CHILD,    M_QUANTITY,  'TGT_REL_PRODUCT_TO_PRODUCT'   , M_PARENT_MATTEL_PRODUCTNUMBER, M_PARENT_MATTEL_DASHCODE,M_CHILD_MATTEL_PRODUCTNUMBER,M_CHILD_MATTEL_DASHCODE  -- LOAD_DTFROM TGT_REL_PRODUCT_TO_PRODUCTLEFT OUTER JOIN SOURCE_ITEM PAR1 ON RPAD(PAR1.P2_TEXT14,5) = RPAD(M_PARENT_MATTEL_PRODUCTNUMBER,5)                      AND RPAD(PAR1.P2_TEXT15,5) = RPAD(M_PARENT_MATTEL_DASHCODE,5)                      AND PAR1.SUBCLASS LIKE 'Asse%'                      AND PAR1.subclass <> 'Electronics Specification Document'                      LEFT OUTER JOIN SOURCE_ITEM CHLD1 ON CHLD1.P2_TEXT14 = M_CHILD_MATTEL_PRODUCTNUMBER                      AND CHLD1.P2_TEXT15 = M_CHILD_MATTEL_DASHCODE                      AND CHLD1.SUBCLASS NOT LIKE 'Asse%'                      AND CHLD1.subclass <> 'Electronics Specification Document' ORDER BY PARENT;COMMIT;SELECT COUNT(*) FROM SOURCE_BOM;SELECT COUNT(*) FROM SOURCE_BOM WHERE PARENT_NUMBER IS NULL;SELECT COUNT(*) FROM SOURCE_BOM WHERE ITEM_NUMBER IS NULL;SELECT COUNT(*) FROM TGT_REL_ASST_MODEL;INSERT INTO SOURCE_BOM(PARENT_NUMBER,ITEM_NUMBER,QUANTITY,TEXT01,TEXT02,TEXT03,TEXT04,TEXT05)SELECT   PAR1.ITEM_NUMBER AS PARENT,   CHLD1.ITEM_NUMBER AS CHILD,    M_QUANTITY,  'TGT_REL_ASST_MODEL'   , M_PARENT_MATTEL_PRODUCT_NUMBER, M_PARENT_LINE_YEAR,M_CHILD_MATTEL_PRODUCTNUMBER,M_CHILD_MATTEL_DASHCODE  -- LOAD_DTFROM TGT_REL_ASST_MODELLEFT OUTER JOIN SOURCE_ITEM PAR1 ON PAR1.P2_TEXT14 = M_PARENT_MATTEL_PRODUCT_NUMBER                      AND PAR1.p3_LIST31 = M_PARENT_LINE_YEAR                      AND PAR1.subclass <> 'Electronics Specification Document'LEFT OUTER JOIN SOURCE_ITEM CHLD1 ON CHLD1.P2_TEXT14 = M_CHILD_MATTEL_PRODUCTNUMBER                      AND CHLD1.P2_TEXT15 = M_CHILD_MATTEL_DASHCODE                      AND CHLD1.subclass <> 'Electronics Specification Document';COMMIT;SELECT COUNT(*) FROM SOURCE_BOM;SELECT COUNT(*) FROM SOURCE_BOM WHERE PARENT_NUMBER IS NULL;SELECT COUNT(*) FROM SOURCE_BOM WHERE ITEM_NUMBER IS NULL;SELECT COUNT(*) FROM TGT_REL_GRS_TO_GRS;INSERT INTO SOURCE_BOM(PARENT_NUMBER,ITEM_NUMBER,QUANTITY)SELECT M_PARENT_GRS_LEVEL_ID,  M_CHILD_GRS_LEVEL_ID,  M_QUANTITY  -- LOAD_DTFROM TGT_REL_GRS_TO_GRS;COMMIT;select count(*) from TGT_REL_ELECSPEC_TO_PRODUCT;INSERT INTO SOURCE_BOM(PARENT_NUMBER,ITEM_NUMBER,QUANTITY,TEXT01,TEXT02,TEXT03,TEXT04,TEXT05)SELECT CHLD1.ITEM_NUMBER AS CHILD, -- the child is the parent. PAR1.ITEM_NUMBER AS PARENT, 1,'TGT_REL_ELECSPEC_TO_PRODUCT', M_ESPEC_MATTEL_PRODUCTNUMBER, '',M_MATTEL_PRODUCTNUMBER,M_MATTEL_DASHCODE  -- LOAD_DTFROM TGT_REL_ELECSPEC_TO_PRODUCTLEFT OUTER JOIN SOURCE_ITEM PAR1 ON PAR1.P2_TEXT14 = TGT_REL_ELECSPEC_TO_PRODUCT.M_ESPEC_MATTEL_PRODUCTNUMBER                      AND PAR1.subclass = 'Electronics Specification Document'JOIN SOURCE_ITEM CHLD1 ON CHLD1.P2_TEXT14 = TGT_REL_ELECSPEC_TO_PRODUCT.M_MATTEL_PRODUCTNUMBER                                 AND CHLD1.P2_TEXT15 = TGT_REL_ELECSPEC_TO_PRODUCT.M_MATTEL_DASHCODE                                 AND CHLD1.subclass <> 'Electronics Specification Document'ORDER BY PARENT;-- delete from source_bom where parent_number is null or item_number is null;-- commit;SELECT COUNT(*) FROM SOURCE_BOM;SELECT COUNT(*) FROM SOURCE_BOM WHERE PARENT_NUMBER IS NULL;SELECT COUNT(*) FROM SOURCE_BOM WHERE ITEM_NUMBER IS NULL;set echo offspool offexit;